<!DOCTYPE html>
<html>
<head>
    <title>Place Order - Chai Chenak Restaurant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Chai Chenak Restaurant - Place Your Order</h1>

        <div class="current-order">
            <h2>Your Current Order (#{{ order_number }})</h2>
            <p>Customer: {{ customer_name }}</p>
            <h3>Items in Your Order:</h3>
            {% if order_items %}
                <table>
                    <tr>
                        <th>Item</th>
                        <th>Quantity</th>
                        <th>Price Each</th>
                        <th>Total</th>
                        <th>Actions</th>
                    </tr>
                    {% for item in order_items %}
                    <tr>
                        <td>{{ item.name }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>${{ "%.2f"|format(item.price) }}</td>
                        <td>${{ "%.2f"|format(item.quantity * item.price) }}</td>
                        <td>
                            <form method="post" action="/modify_item">
                                <input type="hidden" name="item_id" value="{{ item.order_item_id }}">
                                <input type="number" name="new_quantity" value="{{ item.quantity }}" min="1" style="width: 50px;">
                                <button type="submit" name="action" value="update">Update</button>
                                <button type="submit" name="action" value="remove">Remove</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                    <tr>
                        <td colspan="3" align="right"><strong>Subtotal:</strong></td>
                        <td colspan="2"><strong>${{ "%.2f"|format(subtotal) }}</strong></td>
                    </tr>
                </table>
                <form method="post" action="/complete_order">
                    <div class="form-group">
                        <label for="delivery_option">Delivery Option:</label>
                        <select name="delivery_option" id="delivery_option">
                            <option value="pickup">Pickup</option>
                            <option value="delivery">Delivery ($5.00)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="tip_percentage">Tip Percentage:</label>
                        <select name="tip_percentage" id="tip_percentage">
                            <option value="0">No Tip</option>
                            <option value="10">10%</option>
                            <option value="15" selected>15%</option>
                            <option value="18">18%</option>
                            <option value="20">20%</option>
                            <option value="25">25%</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="coupon_type">Coupon Type:</label>
                        <select name="coupon_type" id="coupon_type">
                            <option value="none">No Coupon</option>
                            <option value="percentage">Percentage Discount</option>
                            <option value="fixed">Fixed Amount Discount</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="coupon_value">Coupon Value:</label>
                        <input type="number" name="coupon_value" id="coupon_value" value="0" min="0" step="0.01">
                    </div>

                    <button type="submit" class="btn">Complete Order</button>
                </form>
            {% else %}
                <p>No items in your order yet.</p>
            {% endif %}
        </div>

        <h2>Menu Categories</h2>
        <form method="get" action="/order">
            <select name="category" onchange="this.form.submit()">
                <option value="">Select a category</option>
                <option value="Appetizers" {% if category == 'Appetizers' %}selected{% endif %}>Appetizers</option>
                <option value="Entrees" {% if category == 'Entrees' %}selected{% endif %}>Entrees</option>
                <option value="Sides" {% if category == 'Sides' %}selected{% endif %}>Sides</option>
            </select>
        </form>

        {% if category %}
        <h3>{{ category }} Menu</h3>
        <div class="menu-category">
            {% for item in menu_items %}
            <div class="menu-item">
                <form method="post" action="/add_to_order">
                    <h4>{{ item.name }} - ${{ "%.2f"|format(item.price) }}</h4>
                    <p>{{ item.description }}</p>
                    <input type="hidden" name="menu_id" value="{{ item.menu_id }}">
                    <label for="quantity">Quantity:</label>
                    <input type="number" name="quantity" id="quantity" value="1" min="1" style="width: 50px;">
                    <button type="submit">Add to Order</button>
                </form>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <p><a href="/" class="btn">Back to Home</a></p>
    </div>
</body>
</html>
